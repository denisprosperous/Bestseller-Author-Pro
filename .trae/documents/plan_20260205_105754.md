I have diagnosed the issues causing the application to fail in production and restrict access to your local machine.

### Diagnosis
1.  **Global Access Issue**: The app relies on `localStorage` for API keys and connection settings, which only exists on your specific browser/machine.
2.  **"Mock User" Crash**: The authentication service aggressively falls back to a "Mock User" (ID: "mock-user-id") when it detects local dev data. The database expects a valid UUID, causing the `invalid input syntax for type uuid: "mock-user-id"` error and crashing the Builder.
3.  **Brainstorm/API Keys**: The "Brainstorm" feature checks the *database* for API keys, but the "Settings" page is currently saving them to *localStorage* (browser only). This mismatch causes the "Add API key" error.
4.  **Missing Tables**: The error `Could not find the table 'public.voice_profiles'` confirms that the comprehensive database schema has not been fully applied.

### Implementation Plan

#### 1. Fix Authentication & "Mock Mode"
*   **Modify `app/services/auth-service.ts`**: Remove the aggressive fallback to "mock-user-id". The app will be forced to use the real Supabase authentication, ensuring valid UUIDs are always passed to the database.

#### 2. Fix Global API Key Access
*   **Modify `app/routes/settings.tsx`**: Disable `USE_LOCAL_STORAGE` mode. API keys will now be encrypted and saved to the `api_keys` table in Supabase, making them accessible from any device.
*   **Modify `app/routes/brainstorm.tsx`**: Ensure it correctly reads keys from the database (which it already tries to do, but will now succeed).

#### 3. Configure Production Environment
*   **Create `.env` file**: Configure `VITE_SUPABASE_PROJECT_URL` and `VITE_SUPABASE_API_KEY` with your project credentials. This ensures the app connects to the real database immediately for all users without manual setup.

#### 4. Deploy & Database Sync
*   **Database Fix**: I will point you to the `database/setup-corrected.sql` file (which I will verify/update) that contains the missing `voice_profiles` table. You will need to run this one file in the Supabase SQL Editor to fix the schema.
*   **Commit & Push**: I will commit all code changes to GitHub.
*   **Deploy**: I will trigger a deployment to Vercel (if I have access, or you can via the dashboard).

This systematic approach resolves the root causes: inconsistent storage (local vs db), mixed auth states (mock vs real), and missing schema elements.